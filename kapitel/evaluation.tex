\section{Evaluation}

Dieses Kapitel evaluiert die entwickelte Middleware und vergleicht die beiden Backend-Ansätze (Excel vs. OData-Services) anhand definierter Kriterien. Die Evaluation orientiert sich an etablierten Methoden der empirischen Softwaretechnik \citep{wohlin2012} und bewertet sowohl die Anforderungserfüllung als auch qualitative Aspekte der Architektur.

\subsection{Vergleichskriterien}

Für den Vergleich der Backend-Ansätze werden folgende Kriterien herangezogen:

\begin{enumerate}
    \item \textbf{Implementierungsaufwand}: Aufwand für die initiale Entwicklung
    \item \textbf{Wartbarkeit}: Aufwand für Änderungen und Fehlerbehebung
    \item \textbf{Erweiterbarkeit}: Aufwand für neue Features
    \item \textbf{Performance}: Antwortzeiten und Durchsatz
    \item \textbf{Datenkonsistenz}: Zuverlässigkeit der Daten
    \item \textbf{Austauschbarkeit}: Aufwand für den Backend-Wechsel
\end{enumerate}

\subsection{Vergleich: Excel-Backend vs. OData-Services}

\begin{table}[H]
\centering
\caption{Vergleich der Backend-Ansätze}
\label{tab:vergleich}
\begin{tabularx}{\textwidth}{lXX}
\toprule
\textbf{Kriterium} & \textbf{Excel/SharePoint} & \textbf{OData Services} \\
\midrule
Setup-Aufwand & Gering -- Excel bereits vorhanden & Mittel -- Service-Konfiguration nötig \\
\midrule
Echtzeitdaten & Nein -- Power Query muss manuell aktualisiert werden & Ja -- direkte Abfrage \\
\midrule
Transaktionen & Nein -- keine ACID-Garantien & Ja -- Datenbank-Transaktionen \\
\midrule
Skalierbarkeit & Begrenzt -- Dateigröße limitiert & Hoch -- Datenbank skaliert \\
\midrule
Offline-Fähigkeit & Ja -- Excel lokal verfügbar & Nein -- Service muss erreichbar sein \\
\midrule
Lernkurve Endnutzer & Gering -- Excel bekannt & Höher -- neue Oberfläche \\
\bottomrule
\end{tabularx}
\end{table}

\subsection{Bewertung der Anforderungserfüllung}

\subsubsection{Funktionale Anforderungen}

\begin{table}[H]
\centering
\caption{Erfüllung der funktionalen Anforderungen}
\label{tab:fa-erfuellung}
\begin{tabularx}{\textwidth}{lXc}
\toprule
\textbf{ID} & \textbf{Anforderung} & \textbf{Status} \\
\midrule
FA-01 & Budget-Metriken pro Team berechnen & Erfüllt \\
FA-02 & Budget-Metriken pro \gls{psp} berechnen & Erfüllt \\
FA-03 & \gls{crud} für \gls{psp}-Zuordnungen & Erfüllt \\
FA-04 & Session-basiertes Projekt-Management & Erfüllt \\
FA-05 & Team-Mismatch-Warnungen & Erfüllt \\
FA-06 & Excel-Daten von SharePoint lesen & Teilweise* \\
FA-07 & Änderungen in Excel schreiben & Erfüllt \\
\bottomrule
\end{tabularx}
\end{table}

*FA-06: Lokales Lesen funktioniert, SharePoint-Berechtigungen noch ausstehend.

\subsubsection{Nicht-funktionale Anforderungen}

\begin{table}[H]
\centering
\caption{Erfüllung der nicht-funktionalen Anforderungen}
\label{tab:nfa-erfuellung}
\begin{tabularx}{\textwidth}{lXc}
\toprule
\textbf{ID} & \textbf{Anforderung} & \textbf{Status} \\
\midrule
NFA-01 & Backend austauschbar & Erfüllt \\
NFA-02 & \gls{odata} v4-kompatibel & Erfüllt \\
NFA-03 & Auf SAP \gls{btp} deploybar & Erfüllt \\
NFA-04 & Für Fiori-Frontend geeignet & Erfüllt \\
NFA-05 & Ohne lokale Datenbank & Erfüllt \\
\bottomrule
\end{tabularx}
\end{table}

\subsection{Bewertung der Austauschbarkeit}

Die zentrale Forschungsfrage zielt auf die Austauschbarkeit des Backends ab. Die Evaluation zeigt:

\subsubsection{Durch das Adapter-Pattern geschützte Komponenten}

\begin{itemize}
    \item \gls{cds} Service-Definition -- keine Änderung nötig
    \item Budget-Berechnungslogik -- keine Änderung nötig
    \item Session-Management -- keine Änderung nötig
    \item \gls{api}-Dokumentation -- keine Änderung nötig
\end{itemize}

\subsubsection{Bei Backend-Wechsel zu ändernde Komponenten}

\begin{itemize}
    \item Neuer OData-Adapter implementieren (analog zu Excel-Adapter)
    \item Konfiguration der Service-Endpunkte
    \item Authentifizierung anpassen (OAuth 2.0 für \gls{calm})
\end{itemize}

\subsubsection{Geschätzter Aufwand für Backend-Wechsel}

Basierend auf der Implementierungserfahrung lässt sich der Aufwand für einen Backend-Wechsel abschätzen:

\begin{table}[H]
\centering
\caption{Geschätzter Aufwand für Backend-Wechsel zu OData}
\label{tab:aufwand}
\begin{tabularx}{\textwidth}{Xlc}
\toprule
\textbf{Komponente} & \textbf{Aufgabe} & \textbf{Aufwand} \\
\midrule
ODataAdapter & Implementierung analog zu ExcelAdapter & 3--5 PT \\
Authentifizierung & OAuth 2.0 für SAP Cloud ALM & 1--2 PT \\
Mapping & Anpassung der Datenstrukturen & 2--3 PT \\
Testing & Integration \& Regressionstests & 2--3 PT \\
\midrule
\textbf{Gesamt} & & \textbf{8--13 PT} \\
\bottomrule
\end{tabularx}
\end{table}

Die Service-Schicht, CDS-Definitionen und das Frontend bleiben dabei unverändert -- ein Beleg für die Wirksamkeit des Adapter-Patterns.

\subsection{Performance-Analyse}

Die Performance wurde auf der deployed Instanz (SAP BTP Cloud Foundry, 256 MB RAM) gemessen. Jeder Endpoint wurde 10-mal aufgerufen und der Median der Antwortzeiten ermittelt.

\begin{table}[H]
\centering
\caption{Antwortzeiten der API-Endpunkte}
\label{tab:performance}
\begin{tabularx}{\textwidth}{Xccc}
\toprule
\textbf{Endpoint} & \textbf{Datenmenge} & \textbf{Median} & \textbf{Max} \\
\midrule
GET /BudgetOverview & 14 Teams & 180 ms & 250 ms \\
GET /UserStories & 251 Stories & 320 ms & 480 ms \\
GET /TimeBookings & 3555 Buchungen & 890 ms & 1.200 ms \\
GET /PSPElements & 113 Elemente & 150 ms & 210 ms \\
POST /startSession & -- & 45 ms & 80 ms \\
\bottomrule
\end{tabularx}
\end{table}

\textbf{Bewertung}: Die Antwortzeiten sind für eine Fiori-Anwendung akzeptabel. Der Großteil der Zeit entfällt auf das Parsen der Excel-Datei. Bei einem Wechsel zu OData-Services wäre mit schnelleren Antwortzeiten zu rechnen, da keine Dateitransformation erforderlich ist.

\subsection{Testszenarien}

Die Middleware wurde anhand definierter Testszenarien validiert:

\subsubsection{Funktionale Tests}

\begin{table}[H]
\centering
\caption{Funktionale Testszenarien}
\label{tab:functional-tests}
\begin{tabularx}{\textwidth}{clXc}
\toprule
\textbf{ID} & \textbf{Szenario} & \textbf{Erwartetes Ergebnis} & \textbf{Status} \\
\midrule
T-01 & Session starten & Session-ID wird zurückgegeben & \checkmark \\
T-02 & Ungültige Session & 401 Unauthorized & \checkmark \\
T-03 & Budget pro Team abrufen & 14 Teams mit korrekten Summen & \checkmark \\
T-04 & Budget pro PSP abrufen & 113 PSP-Elemente & \checkmark \\
T-05 & OData \$filter anwenden & Gefilterte Ergebnisse & \checkmark \\
T-06 & OData \$top/\$skip & Paginierung funktioniert & \checkmark \\
T-07 & PSP-Zuordnung erstellen & Eintrag in Excel geschrieben & \checkmark \\
T-08 & PSP-Zuordnung löschen & Eintrag aus Excel entfernt & \checkmark \\
T-09 & Team-Mismatch erkennen & Warnung wird generiert & \checkmark \\
T-10 & Projekt wechseln & Neue Session für anderes Projekt & \checkmark \\
\bottomrule
\end{tabularx}
\end{table}

\subsubsection{Grenzwert-Tests}

\begin{table}[H]
\centering
\caption{Grenzwert-Testszenarien}
\label{tab:boundary-tests}
\begin{tabularx}{\textwidth}{lXc}
\toprule
\textbf{Szenario} & \textbf{Erwartetes Verhalten} & \textbf{Status} \\
\midrule
Leere Excel-Datei & Leere Arrays werden zurückgegeben & \checkmark \\
User Story ohne PSP & pspElement = \enquote{unassigned}, nicht in ETC & \checkmark \\
PSP ohne Budget & budgetPT = 0 & \checkmark \\
Doppelte PSP-Zuordnung & 409 Conflict & \checkmark \\
Session nach 8h & 401 Session abgelaufen & \checkmark \\
Ungültiges Projekt & 404 Not Found & \checkmark \\
\bottomrule
\end{tabularx}
\end{table}

\subsection{SWOT-Analyse der Architektur}

Eine SWOT-Analyse fasst die Stärken, Schwächen, Chancen und Risiken der gewählten Architektur zusammen:

\begin{table}[H]
\centering
\caption{SWOT-Analyse der BC Middleware Architektur}
\label{tab:swot}
\begin{tabularx}{\textwidth}{|X|X|}
\hline
\textbf{Stärken (Strengths)} & \textbf{Schwächen (Weaknesses)} \\
\hline
\begin{itemize}[leftmargin=*, nosep]
    \item Austauschbares Backend durch Adapter-Pattern
    \item OData-Konformität für Fiori-Integration
    \item Keine zusätzliche Datenbank erforderlich
    \item Einfaches Deployment auf SAP BTP
    \item Excel als vertraute Datenquelle für Anwender
\end{itemize}
&
\begin{itemize}[leftmargin=*, nosep]
    \item Keine Echtzeitdaten (Excel-Refresh nötig)
    \item Sessions nicht persistent
    \item Keine ACID-Transaktionen
    \item Begrenzte Skalierbarkeit bei großen Excel-Dateien
    \item SharePoint-Integration noch nicht produktiv
\end{itemize}
\\
\hline
\textbf{Chancen (Opportunities)} & \textbf{Risiken (Threats)} \\
\hline
\begin{itemize}[leftmargin=*, nosep]
    \item Migration zu SAP Cloud ALM möglich
    \item Erweiterung um weitere Projektcontrolling-Funktionen
    \item Integration mit SAP Analytics Cloud
    \item Wiederverwendung des Patterns für andere Projekte
\end{itemize}
&
\begin{itemize}[leftmargin=*, nosep]
    \item Excel-Datei wird versehentlich beschädigt
    \item Konkurrierende Zugriffe auf Excel
    \item API-Änderungen bei SAP Cloud ALM
    \item Performance bei sehr großen Projekten
\end{itemize}
\\
\hline
\end{tabularx}
\end{table}

\subsection{Lessons Learned}

Aus der Implementierung und dem Betrieb der Middleware ergeben sich folgende Erkenntnisse:

\begin{enumerate}
    \item \textbf{Adapter-Pattern bewährt sich}: Die strikte Trennung zwischen Service- und Adapter-Schicht hat sich als praktikabel erwiesen. Änderungen am Excel-Format erforderten nur Anpassungen im Adapter, nicht in der Geschäftslogik. Dies bestätigt die Empfehlungen von \cite{gamma1994}.

    \item \textbf{Excel-Schreiben komplexer als Lesen}: Das Zurückschreiben in Excel erfordert sorgfältige Handhabung des Formats. Insbesondere Formeln, Formatierungen und Zellreferenzen müssen erhalten bleiben. Die xlsx-Bibliothek unterstützt dies, erfordert aber detailliertes Verständnis der Excel-Interna.

    \item \textbf{\gls{cds} beschleunigt Entwicklung}: Die deklarative Service-Definition reduziert Boilerplate-Code erheblich. OData-Konformität, Filterung und Paginierung werden automatisch bereitgestellt \citep{sap2024cap}.

    \item \textbf{Session-Management im RAM riskant}: Bei Serverneustart gehen Sessions verloren. Für den produktiven Einsatz wäre eine Persistierung (z.B. Redis, Datenbank) erforderlich \citep{richardson2018}.

    \item \textbf{Middleware als Integrationsmuster}: Die Middleware fungiert als \enquote{Anti-Corruption Layer} \citep{vernon2013} und schützt das Frontend vor den Eigenheiten der Excel-Struktur.
\end{enumerate}
